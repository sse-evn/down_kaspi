"use strict";function _objectValues(e){for(var n=[],t=Object.keys(e),i=0;i<t.length;i++)n.push(e[t[i]]);return n}var _logEventsMpHelper={};_logEventsMpHelper={init:function(){var e=this;if(e.$isMobileApp=$.cookie("is_mobile_app"),e.$pushedItems=[],e.$counterItems=0,"true"!==e.$isMobileApp)return null;e.bindInitialPush(),e.bindEventClickItems(),e.bindEventScrollItems(),e.bindEventBeforeUnloadItems()},bindInitialPush:function(){var n=this;_objectValues($("a[data-log-event=true]")).forEach(function(e){n.isElemVisible(e)&&null!=(e=n.prepareItemBeforePush(e,"view"))&&n.$pushedItems.push(e)}),n.bindPushItems(n.$pushedItems)},bindEventClickItems:function(){var t=this;$("a[data-trigger=click]").each(function(){$(this).click(function(e){clearTimeout(t.timerId);var n=t.prepareItemBeforePush(this,"click");null!=n&&t.$pushedItems.push(n),t.bindPushItems(t.$pushedItems)})})},bindEventBeforeUnloadItems:function(){var e=this;$(window).on("beforeunload",function(){0!==e.$pushedItems.length&&e.bindPushItems(e.$pushedItems)})},bindEventScrollItems:function(){function e(){t.forEach(function(e){n.isElemVisible(e)&&null!=(e=n.prepareItemBeforePush(e,"view"))&&(clearTimeout(n.timerId),n.$pushedItems.push(e),n.bindPushItemsWithTimer(e))})}var n=this,t=_objectValues($("a[data-log-event=true]"));null!=mainBannerHelper&&"undefined"!=mainBannerHelper&&null!=mainBannerHelper.startMainBannerAdaptSwiper&&"undefined"!=mainBannerHelper.startMainBannerAdaptSwiper&&mainBannerHelper.startMainBannerAdaptSwiper.on("setTranslate",e),$(".shopCarousel .shopCarousel__items").on("scroll",e),$(window).on("scroll",e)},prepareItemBeforePush:function(t,e){var i,n=$(t),e=(_objectValues(n.parents(".startSection__wrapper").find("[data-log-event]")).find(function(e,n){t===e&&(i=++n)}),{action:e+"ed",objectId:n.parents(".startSection__wrapper").data("name"),campaignId:n.data("campaign-id"),position:i,trigger:n.data("trigger")});return"SHOP"==e.objectId&&(e.objectId=e.objectId+"_3",e.productSKU=n.data("id")),_objectValues(e).every(function(e){return null!=e&&"undefined"!=e})?(this.$counterItems++,e):null},bindPushItems:function(){var n,e=this,t=JSON.stringify(e.$pushedItems);null!=window.mobapp&&"undefined"!=window.mobapp&&0!==e.$pushedItems.length&&("function"==typeof window.mobapp.logServerEvents?(n={events:[]},e.$pushedItems.forEach(function(e){n.events.push({name:"pcm",sendType:"onceForSession",parameters:e})}),mobapp.logServerEvents(JSON.stringify(n))):mobapp.logPcmEvents(t)),e.$pushedItems=[]},bindPushItemsWithTimer:function(e){var n=this;n.timerId=setTimeout(function(){n.bindPushItems(e)},3e3)},isElemVisible:function(e){var n;return!!$(e).is("[data-log-event=true]")&&((n=(n=e.getBoundingClientRect()).top<window.innerHeight&&0<=n.bottom&&n.left<=window.innerWidth&&0<=n.right)&&(e.dataset.logEvent="false"),n)}},$(function(){_logEventsMpHelper.init()});