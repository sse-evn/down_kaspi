"use strict";var mainBannerHelper;"undefined"==typeof headerHelper&&(window.headerHelper={}),headerHelper.init=function(){headerHelper.bindSettingsEvents(),headerHelper.bindShowRegionsList(),headerHelper.bindRegionConfirmation(),headerHelper.bindLangSwitcher()},headerHelper.bindSettingsEvents=function(){$("#headerSettings").length&&($(".headerAuth__wrapper").on("click.bindSettingsEvents",function(){$(this).toggleClass("headerAuth__wrapper--active")}),$("#headerSettings").on("click.bindSettingsEvents",function(e){(e=e||event).stopPropagation()}))},headerHelper.bindShowRegionsList=function(){var n=this;$(".headerRegionSelection__region",n.$headerMenuOpener).off("click.selectRegionHelper").on("click.selectRegionHelper",function(e){e=e||window.event;$(this);n.showRegionsList(e)})},headerHelper.bindLangSwitcher=function(){$(".switcher__tab").on("click",function(){var e=$(this);e.hasClass("switcher__tab--active")||($.removeCookie("locale"),e=e.attr("id"),$.cookie("locale",e,{path:"/;SameSite=Lax",domain:".kaspi.kz"}),$.cookie("locale",e,{path:"/;SameSite=Lax"}),window.location.reload())})},headerHelper.showRegionsList=function(e){e=e||window.event;"undefined"==typeof selectRegionHelper?($("body").mask(),$.ajax({url:"/start/SelectRegion/desktop",type:"POST",dataType:"html",success:function(e){e&&e.trim()?($("body").append(e),$("body").unmask()):location.href="/entrance"}})):selectRegionHelper.toggle(e)},headerHelper.bindRegionConfirmation=function(){var n,t=this;function i(e){t.$headerMenuOpener.removeClass("headerRegionSelection__wrapper--confirmation"),t.$headerMenuOpener.off("click",i),n.remove()}(n=$(".headerRegionConfirm__wrapper")).length&&(t.$headerMenuOpener=$("#headerRegionSelection"),$("#headerRegionConfirm__ConfirmButton",n).on("click.selectRegionHelper",function(){var e=$(this).data("region-id");i(),$.removeCookie("kaspi-payment-region"),$.cookie("kaspi-payment-region",e,{expires:365,path:"/"}),$.removeCookie("kaspi-trusted-region-id"),$.cookie("kaspi-trusted-region-id",e,{expires:365,path:"/"}),(digitalData=digitalData||{}).events=digitalData.events||[],digitalData.events.push({category:"Behaviour",name:"Changed City",label:$(this).data("region-title")}),location.reload()}),$("#headerRegionConfirm__CancelButton",n).on("click.selectRegionHelper",function(e){e=e||window.event,t.showRegionsList(e),i()}),t.$headerMenuOpener.on("click",function(){i()}),n.on("click.selectRegionHelper",function(e){"function"==typeof(e=e||window.event).stopPropagation&&e.stopPropagation()}),$.cookie("kaspi-region-confirm-shown","true",{expires:365,path:"/"}))},$(function(){headerHelper.init()}),"undefined"==typeof footerHelper&&(window.footerHelper={}),footerHelper.init=function(){(this.$wrapper=$(".footer__wrapper")).length&&footerHelper.bindChangeLocale()},footerHelper.bindChangeLocale=function(){$("#footerSwitchLocale").off("click.kaspiMenu").on("click.kaspiMenu",function(e){(e=e||window.event).preventDefault(),e.stopPropagation();e=$(this).data("locale");$.ajax({url:"/SwitchLocale/"+e,type:"POST",dataType:"json",success:function(e){"OK"==e.status&&location.reload()}}).always(function(){})})},$(function(){footerHelper.init()}),mainBannerHelper={},mainBannerHelper={init:function(){var e=this;(e.$wrapper=$("#startMainBanner, #startMainBannerAdapt")).length&&(e.addPolyfills(),e.swapBanners(),e.bindLinks(),e.bindStartSlider(),e.bindPaymentsSwiper(),e.switchBanners(),e.stopRotation())},bindLinks:function(){this.$wrapper.find("[data-type=link][data-href]").on("click.mainBannerHelper",function(e){e=e||window.event,"a"!=((event=event||window.event).target||event.srcElement).tagName.toLowerCase()&&(e=$(this),location.href=e.data("href"))})},bindStartSlider:function(){var e=this,n=(e.$startMainBannerAdapt=$("#startMainBannerAdapt"),e.$startMainBannerAdapt),t=(e.$startMainBannerAdapt.data("rotation-enabled"),$(".startMainBanner__item",n)),t=(n.addClass("swiper-container"),$(".startMainBannerAdapt__inner",n).addClass("swiper-wrapper"),t.length?t.addClass("swiper-slide"):e.$startMainBannerAdapt.addClass("startMainBannerAdapt__wrapper--empty"),{slidesPerView:"auto",loop:!0,loopedSlides:30,preventClicks:!1,centeredSlides:!0,lazy:{loadOnTransitionStart:!0}});n.hasClass("startMainBannerAdapt__wrapper--new")||n.hasClass("startMainBannerAdapt__wrapper--promo")||(t.paginationClickable=!0,t.pagination={el:".startMainBannerAdapt__pagination"}),n.hasClass("startMainBannerAdapt__wrapper--promo")&&(t.loop=!1,t.centeredSlides=!1,t.lazy={loadOnTransitionStart:!0,loadPrevNext:!0,loadPrevNextAmount:3}),e.startMainBannerAdaptSwiper=new Swiper(n,t)},bindPaymentsSwiper:function(){var n=this;$(".startMainBanner__itemWrapper--small #paymentsLogos, #startMainBannerAdapt #paymentsLogos").each(function(){var e=$(this);e.addClass("swiper-container"),$(".paymentsLogos__inner",e).addClass("swiper-wrapper"),$(".paymentsLogos__item",e).addClass("swiper-slide"),n.paymentsLogosSwiper=new Swiper(e,{slidesPerView:"auto",loop:!0,loopedSlides:30,preventClicks:!1,nested:!0,lazy:{loadOnTransitionStart:!0}})})},swapBanners:function(){var e=this.$wrapper.data("banners"),n=$.cookie("user-device-type");if(void 0===n&&(n="Desktop"),e){if(1<(o=JSON.parse(decodeURIComponent(e))).length){e=void 0!==$.cookie("is_mobile_app")&&"true"===$.cookie("is_mobile_app").toLowerCase();if("Mobile"===n||e)for(var t=$("#mainBanners"),i=0;i<o.length;i++)t.append('<span class="startMainBanner__item mainBanner'+i+'"></span>');var a=[],r=$.cookie("start-banners");if(r){var o,s=JSON.parse(r),a=o.filter(function(e){return e.ShowFirst});if((o=o.filter(function(e){return!e.ShowFirst})).forEach(function(n){var e=s.find(function(e){return e.Id===n.Id});void 0!==e&&(n.Position=e.Position,n.IsNew=!1)}),-1===(p=o.findIndex(function(e){return e.IsNew}))){for(var p,d=o[p=0].Position,l=0;l<o.length;l++)o[l].Position<d&&(d=o[l].Position,p=l);--p<0&&(p=o.length-1)}o=[].concat(o.slice(p),o.slice(0,p))}else a=o.filter(function(e){return e.ShowFirst}),o=o.filter(function(e){return!e.ShowFirst});o=o.map(function(e,n){return e.Position=n+1,e}),o=a.concat(o);for(var c="Mobile"===n||e||o.length<3?o.length:3,i=0;i<c;i++){var f=$("#bannersCollection"+o[i].Id);$(".mainBanner"+i).append(f.html()),2===o[i].Id&&mainBannerHelper.bindPaymentsSwiper(),f.empty()}}else o=o.map(function(e,n){return e.Position=n+1,e});$.cookie("start-banners",JSON.stringify(o));r=o.map(function(e){return{id:e.CampaignId,position:e.Position.toString()}}),a=r.findIndex(function(e){return"app-link-17"===e.id});-1!==a&&(n=r[a],r.splice(a,1),r.push({id:n.id+"_1",position:n.position}),r.push({id:n.id+"_2",position:n.position})),$("#myBankBanner").length&&r.push({id:"my-bank-9-2",position:(o.length+1).toString()}),void 0!==window.digitalData&&(digitalData.campaigns=r,digitalData.campaigns.forEach(function(e){var n=$('*[data-campaign-id="'+e.id+'"]').attr("data-name");e.name=n}),$("#bonus a").each(function(){var e={};e.id=$(this).attr("data-campaign-id"),e.position="Секция АКЦИИ KASPI БОНУС",e.name=$(this).attr("data-name"),digitalData.campaigns.push(e)}))}else window.digitalData=window.digitalData||{},window.digitalData.campaigns=window.digitalData.campaigns||[],$(".startMainBanner__item",this.$wrapper).each(function(e){window.digitalData.campaigns.push({id:$(this).data("campaign-id"),name:$(this).data("name"),position:e+1})})},switchBanners:function(){var n=this;$('.startMainBanner__item  [data-toggle-banners="first"]').on("click",function(e){e.preventDefault(),$(this).siblings('[data-toggle-banners="second"]').show(),$(this).hide()}),$('.startMainBanner__item  [data-toggle-banners="second"]').on("click",function(e){e.preventDefault();e=$(this).parent().attr("data-swiper-slide-index");n.startMainBannerAdaptSwiper.removeSlide(e)})},stopRotation:function(){var n=this;$('.startMainBanner__item  [data-stop-rotation="true"]').on("click",function(e){n.startMainBannerAdaptSwiper.autoplay.stop()})},addPolyfills:function(){Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n,t=Object(this),i=t.length>>>0,a=arguments[1],r=0;r<i;r++)if(n=t[r],e.call(a,n,r,t))return r;return-1}),Array.prototype.find||(Array.prototype.find=function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n,t=Object(this),i=t.length>>>0,a=arguments[1],r=0;r<i;r++)if(n=t[r],e.call(a,n,r,t))return n}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,n){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),i=t.length>>>0;if(0!=i)for(var a,r,n=0|n,o=Math.max(0<=n?n:i-Math.abs(n),0);o<i;){if((a=t[o])===(r=e)||"number"==typeof a&&"number"==typeof r&&isNaN(a)&&isNaN(r))return!0;o++}return!1}})},bindBannerInputmask:function(){$("[data-inputmask]",this.$startMainBannerAdapt).inputmask()}},$(function(){mainBannerHelper.init()});